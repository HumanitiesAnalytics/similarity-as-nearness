---
title: "Compare Distances"
format:
  html:
    theme: simple
    echo: true
    code-fold: false
    code-summary: "Click to View Source Code"
    self-contained: true
execute:
  fig-width: 10
  fig-height: 7
page-layout: full
toc: true
---

```{r}
library(tidyverse)
library(philentropy)
```

```{r}
review_meta <- read_csv('review_metadata.csv')

excerpts_full <- read_csv('book-reviews/csv/excerpt_review_features.csv')
excerpts_no_hapax <- read_csv('book-reviews/csv/excerpt_review_features_no_hapax.csv')

reviews_full <- read_csv('book-reviews/csv/review_features.csv')
reviews_no_hapax <- read_csv('book-reviews/csv/review_features_no_hapax.csv')

reading_level <- excerpts_full %>% select(syllables, sentence_len) 

reading_level_distances <- philentropy::distance(reading_level, method='euclidean', mute.message=TRUE)

reading_level_full <- reviews_full %>% select(syllables, sentence_len) 

reading_level_distances_full <- philentropy::distance(reading_level_full, method='euclidean', mute.message=TRUE)

# function word Manhattan 
# adjs cosine
# content word cosine
```

```{r}
reading_level_distances[,1]
```
```{r}
review_meta
```

```{r}
review_meta$euclidean <- reading_level_distances_full[,5]
review_meta
```

```{r}
# visualize 
reading_level_plot <- reading_level %>% mutate(text = c("Root Excerpt", "Candidate 1", "Candidate 2", "Candidate 3"))
reading_level_plot_root <- reading_level_plot %>% filter(text == "Root Excerpt")
reading_level_plot_candidates <- reading_level_plot %>% filter(text != "Root Excerpt")

ggplot(reading_level_plot_candidates, aes(x=syllables, y=sentence_len, color=text)) + 
  geom_point() + 
  labs(title = "Book Review Similarity (Excerpts)\n", 
       x = "Average syllables per word", 
       y = "Average sentence length", 
       color = "Excerpt\n") +
  geom_point(aes(x=reading_level_plot_root$syllables, y=reading_level_plot_root$sentence_len), color='black', shape='*', size=10) + 
    annotate("text", x=reading_level_plot_root$syllables, y=reading_level_plot_root$sentence_len + 1.95, label = "Root Excerpt", color = "black", size = 3.5, fontface = "bold") + 
  xlim(0, 2) + 
  ylim(0, 40) +
  geom_segment(aes(x = 0, y = 0, xend = reading_level_plot_root$syllables, yend = reading_level_plot_root$sentence_len), color = "black", linetype = "solid", size = 0.5) + 
  geom_segment(aes(x = 0, y = 0, xend = reading_level_plot_candidates$syllables, yend = reading_level_plot_candidates$sentence_len,color = text),  linetype = "solid", size = 0.5)

```

```{r}
# Define the vectors
A <- c(3, 0)
B <- c(3, 4)

M <- rbind(A, B)

# Calculate dot product
dot_product <- sum(A * B)

# Calculate magnitudes
magnitude_A <- sqrt(sum(A^2))
magnitude_B <- sqrt(sum(B^2))

# Calculate cosine similarity
cosine_similarity <- dot_product / (magnitude_A * magnitude_B)

print(cosine_similarity)
print(philentropy::distance(M, method='cosine'))




# visualize 
#ggplot(train_test, aes(x=a, y=b, color=c)) + 
#  geom_point() + 
#  labs(title = "Identifying time travel movie fans\n", 
#       x = "Used the word 'paradox' X times", 
#       y = "Number of math classes taken in college", 
#       color = "Likes time travel movies\n")

```



